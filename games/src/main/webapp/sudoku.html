<!DOCTYPE html>
<html>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<link href="css/main.css" rel="stylesheet">
<link href="css/util.css" rel="stylesheet">
<body>
	<div class="container-login100"
		style="background-image: url('images/bg-01.jpg');">
		<div class="wrap-login100 p-l-55 p-r-55 p-t-50 p-b-40">
			<span class="login100-form-title p-b-40"> Sudoku </span>
			<div class="container-login100-form-btn p-b-20 ">
				<div class="wrap-login100-form-btn">
					<div class="login100-form-bgbtn"></div>
					<button class="login100-form-btn" onclick="myFunction()"
						id="btnReset">Buscar oponentes</button>
				</div>
			</div>
			<div>
				<p class="input100" id="demo"></p>
			</div>
			<table>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="00"
						onkeyup="sendKey(00)"></td>
					<td><input maxlength="1" type="text" class="grid" id="01"
						onkeyup="sendKey(01)"></td>
					<td><input maxlength="1" type="text" class="grid" id="02"
						onkeyup="sendKey(02)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="03" onkeyup="sendKey(03)"></td>
					<td><input maxlength="1" type="text" class="grid" id="04"
						onkeyup="sendKey(04)"></td>
					<td><input maxlength="1" type="text" class="grid" id="05"
						onkeyup="sendKey(05)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="06" onkeyup="sendKey(06)"></td>
					<td><input maxlength="1" type="text" class="grid" id="07"
						onkeyup="sendKey(07)"></td>
					<td><input maxlength="1" type="text" class="grid" id="08"
						onkeyup="sendKey(08)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="10"
						onkeyup="sendKey(10)"></td>
					<td><input maxlength="1" type="text" class="grid" id="11"
						onkeyup="sendKey(11)"></td>
					<td><input maxlength="1" type="text" class="grid" id="12"
						onkeyup="sendKey(12)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="13" onkeyup="sendKey(13)"></td>
					<td><input maxlength="1" type="text" class="grid" id="14"
						onkeyup="sendKey(14)"></td>
					<td><input maxlength="1" type="text" class="grid" id="15"
						onkeyup="sendKey(15)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="16" onkeyup="sendKey(16)"></td>
					<td><input maxlength="1" type="text" class="grid" id="17"
						onkeyup="sendKey(17)"></td>
					<td><input maxlength="1" type="text" class="grid" id="18"
						onkeyup="sendKey(18)"></td>
				</tr>
				<tr class="bordeTd">
					<td><input maxlength="1" type="text" class="grid" id="20"
						onkeyup="sendKey(20)"></td>
					<td><input maxlength="1" type="text" class="grid" id="21"
						onkeyup="sendKey(21)"></td>
					<td><input maxlength="1" type="text" class="grid" id="22"
						onkeyup="sendKey(22)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="23" onkeyup="sendKey(23)"></td>
					<td><input maxlength="1" type="text" class="grid" id="24"
						onkeyup="sendKey(24)"></td>
					<td><input maxlength="1" type="text" class="grid" id="25"
						onkeyup="sendKey(25)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="26" onkeyup="sendKey(26)"></td>
					<td><input maxlength="1" type="text" class="grid" id="27"
						onkeyup="sendKey(27)"></td>
					<td><input maxlength="1" type="text" class="grid" id="28"
						onkeyup="sendKey(28)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="30"
						onkeyup="sendKey(30)"></td>
					<td><input maxlength="1" type="text" class="grid" id="31"
						onkeyup="sendKey(31)"></td>
					<td><input maxlength="1" type="text" class="grid" id="32"
						onkeyup="sendKey(32)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="33" onkeyup="sendKey(33)"></td>
					<td><input maxlength="1" type="text" class="grid" id="34"
						onkeyup="sendKey(34)"></td>
					<td><input maxlength="1" type="text" class="grid" id="35"
						onkeyup="sendKey(35)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="36" onkeyup="sendKey(36)"></td>
					<td><input maxlength="1" type="text" class="grid" id="37"
						onkeyup="sendKey(37)"></td>
					<td><input maxlength="1" type="text" class="grid" id="38"
						onkeyup="sendKey(38)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="40"
						onkeyup="sendKey(40)"></td>
					<td><input maxlength="1" type="text" class="grid" id="41"
						onkeyup="sendKey(41)"></td>
					<td><input maxlength="1" type="text" class="grid" id="42"
						onkeyup="sendKey(42)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="43" onkeyup="sendKey(43)"></td>
					<td><input maxlength="1" type="text" class="grid" id="44"
						onkeyup="sendKey(44)"></td>
					<td><input maxlength="1" type="text" class="grid" id="45"
						onkeyup="sendKey(45)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="46" onkeyup="sendKey(46)"></td>
					<td><input maxlength="1" type="text" class="grid" id="47"
						onkeyup="sendKey(47)"></td>
					<td><input maxlength="1" type="text" class="grid" id="48"
						onkeyup="sendKey(48)"></td>
				</tr>
				<tr class="bordeTd">
					<td><input maxlength="1" type="text" class="grid" id="50"
						onkeyup="sendKey(50)"></td>
					<td><input maxlength="1" type="text" class="grid" id="51"
						onkeyup="sendKey(51)"></td>
					<td><input maxlength="1" type="text" class="grid" id="52"
						onkeyup="sendKey(52)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="53" onkeyup="sendKey(53)"></td>
					<td><input maxlength="1" type="text" class="grid" id="54"
						onkeyup="sendKey(54)"></td>
					<td><input maxlength="1" type="text" class="grid" id="55"
						onkeyup="sendKey(55)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="56" onkeyup="sendKey(56)"></td>
					<td><input maxlength="1" type="text" class="grid" id="57"
						onkeyup="sendKey(57)"></td>
					<td><input maxlength="1" type="text" class="grid" id="58"
						onkeyup="sendKey(58)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="60"
						onkeyup="sendKey(60)"></td>
					<td><input maxlength="1" type="text" class="grid" id="61"
						onkeyup="sendKey(61)"></td>
					<td><input maxlength="1" type="text" class="grid" id="62"
						onkeyup="sendKey(62)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="63" onkeyup="sendKey(63)"></td>
					<td><input maxlength="1" type="text" class="grid" id="64"
						onkeyup="sendKey(64)"></td>
					<td><input maxlength="1" type="text" class="grid" id="65"
						onkeyup="sendKey(65)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="66" onkeyup="sendKey(66)"></td>
					<td><input maxlength="1" type="text" class="grid" id="67"
						onkeyup="sendKey(67)"></td>
					<td><input maxlength="1" type="text" class="grid" id="68"
						onkeyup="sendKey(68)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="70"
						onkeyup="sendKey(70)"></td>
					<td><input maxlength="1" type="text" class="grid" id="71"
						onkeyup="sendKey(71)"></td>
					<td><input maxlength="1" type="text" class="grid" id="72"
						onkeyup="sendKey(72)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="73" onkeyup="sendKey(73)"></td>
					<td><input maxlength="1" type="text" class="grid" id="74"
						onkeyup="sendKey(74)"></td>
					<td><input maxlength="1" type="text" class="grid" id="75"
						onkeyup="sendKey(75)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="76" onkeyup="sendKey(76)"></td>
					<td><input maxlength="1" type="text" class="grid" id="77"
						onkeyup="sendKey(77)"></td>
					<td><input maxlength="1" type="text" class="grid" id="78"
						onkeyup="sendKey(78)"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="80"
						onkeyup="sendKey(80)"></td>
					<td><input maxlength="1" type="text" class="grid" id="81"
						onkeyup="sendKey(81)"></td>
					<td><input maxlength="1" type="text" class="grid" id="82"
						onkeyup="sendKey(82)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="83" onkeyup="sendKey(83)"></td>
					<td><input maxlength="1" type="text" class="grid" id="84"
						onkeyup="sendKey(84)"></td>
					<td><input maxlength="1" type="text" class="grid" id="85"
						onkeyup="sendKey(85)"></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="86" onkeyup="sendKey(86)"></td>
					<td><input maxlength="1" type="text" class="grid" id="87"
						onkeyup="sendKey(87)"></td>
					<td><input maxlength="1" type="text" class="grid" id="88"
						onkeyup="sendKey(88)"></td>
				</tr>
			</table>
			<div class="container-login100-form-btn p-t-20 p-b-20">
				<div class="wrap-login100-form-btn">
					<div class="login100-form-bgbtn"></div>
					<button class="login100-form-btn" onclick="solve()" id="btnSolve">Solve</button>
				</div>
			</div>
		</div>
		<div class="wrap-login100 p-l-55 p-r-55 p-t-50 p-b-40">
			<span class="login100-form-title p-b-40 p-t-35"> Oponent
				Sudoku </span>
			<table>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e00"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e01"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e02"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e03" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e04"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e05"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e06" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e07"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e08"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e10"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e11"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e12"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e13" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e14"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e15"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e16" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e17"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e18"
						readonly></td>
				</tr>
				<tr class="bordeTd">
					<td><input maxlength="1" type="text" class="grid" id="e20"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e21"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e22"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e23" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e24"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e25"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="26" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e27"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e28"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e30"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e31"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e32"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e33" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e34"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e35"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e36" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e37"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e38"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e40"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e41"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e42"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e43" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e44"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e45"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e46" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e47"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e48"
						readonly></td>
				</tr>
				<tr class="bordeTd">
					<td><input maxlength="1" type="text" class="grid" id="e50"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e51"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e52"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e53" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e54"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e55"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e56" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e57"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e58"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e60"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e61"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e62"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e63" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e64"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e65"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e66" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e67"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e68"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e70"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e71"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e72"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e73" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e74"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e75"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e76" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e77"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e78"
						readonly></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="e80"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e81"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e82"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e83" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e84"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e85"
						readonly></td>
					<td class="gridBorde"><input maxlength="1" type="text"
						class="grid" id="e86" readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e87"
						readonly></td>
					<td><input maxlength="1" type="text" class="grid" id="e88"
						readonly></td>
				</tr>
			</table>
		</div>
	</div>
</body>
<script>
	var board;
	var start;
	var end;
	var ws;
	var x = [];
	var player0, player1;
	function myFunction() {
		ws = new WebSocket("ws://localhost:8080/gamews");
		ws.onopen = function() {
			var p = {
				TYPE : "joinGame",
				game : "sudoku"
			}
			ws.send(JSON.stringify(p));
		}
		ws.onmessage = function(message) {
			var data = message.data;
			data = JSON.parse(data);
			if (data.TYPE == "search") {
				document.getElementById("demo").innerHTML = "" + data.text;
			} else if (data.TYPE == "match") {
				document.getElementById("demo").innerHTML = "" + data.text;
				player0 = data.player0;
				player1 = data.player1;
				var p = {
					TYPE : "sudoku",
					text : "board"
				}
				ws.send(JSON.stringify(p));
			} else if (data.TYPE == "createBoard") {
				board = data.text.toString();
				start = new Date().getTime();
				var i, j, elem = 0;
				var blank = 48;
				for (i = 0; i < 9; i++) {
					for (j = 0; j < 9; j++) {
						var res = i.toString().concat(j.toString());
						grid = document.getElementById(res);
						if (blank > 0) {
							if (getRandomArbitrary() < 6) {
								grid.value = "";
								blank--;
							} else {
								grid.value = board.charAt(elem);
								grid.readOnly = true;
								x.push(res);
							}
						} else {
							grid.value = board.charAt(elem);
							grid.readOnly = true;
							x.push(res)
						}
						elem++;
					}
				}
				sendWritted();
			} else if (data.TYPE == "winner") {
				document.getElementById("demo").innerHTML = "" + data.text;
				ws.onclose();
			} else if (data.TYPE == "looser") {
				document.getElementById("demo").innerHTML = "" + data.text;
				ws.onclose();
			} else if (data.TYPE == "selected") {
				grid = document.getElementById(data.item);
				grid.style.background = "#EB1616";
			}
		}
		ws.onclose = function() {
			alert("Fin partida");
			window.location.href = "http://localhost:8080/menu.html";
		}
	}
	function sendWritted(){
		while (x.length>0){
			sendKey(x.pop());
		}
	}
	function getRandomArbitrary() {
		return Math.round(Math.random() * 10);
	}
	function solve() {
		var correct = true;
		var i, j, elem = 0;
		for (i = 0; i < 9; i++) {
			for (j = 0; j < 9; j++) {
				var res = i.toString().concat(j.toString());
				grid = document.getElementById(res);
				if (grid.value != board.charAt(elem)) {
					grid.style.background = "#EB1616";
					correct = false;
				} else {
					grid.style.background = "#26FA0A";
				}
				elem++;
			}
		}
		if (correct == true) {
			var p = {
				TYPE : "sudoku",
				text : "winner",
				player0 : player0.toString(),
				player1 : player1.toString()
			}
			ws.send(JSON.stringify(p));
		}
	}
	function sendKey(value) {
		var p = {
			TYPE : "sudoku",
			text : "key",
			selected : "" + value,
			player0 : player0.toString(),
			player1 : player1.toString()
		}
		ws.send(JSON.stringify(p));
	}
</script>
</html>
