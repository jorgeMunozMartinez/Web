<!DOCTYPE html>
<html>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<link href="css/main.css" rel="stylesheet">
<link href="css/util.css" rel="stylesheet">
<body>
	<div class="container-login100"
		style="background-image: url('images/bg-01.jpg');">
		<div class="wrap-login100 p-l-55 p-r-55 p-t-50 p-b-40">
			<span class="login100-form-title p-b-40"> Sudoku </span>
			<div class="container-login100-form-btn p-b-20 ">
				<div class="wrap-login100-form-btn">
					<div class="login100-form-bgbtn"></div>
					<button class="login100-form-btn" onclick="myFunction()"
						id="btnReset">Buscar oponentes</button>
				</div>
			</div>
			<div>
				<p class="input100" id="demo"></p>
			</div>
			<table>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="00"></td>
					<td><input maxlength="1" type="text" class="grid" id="01"></td>
					<td><input maxlength="1" type="text" class="grid" id="02"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="03"></td>
					<td><input maxlength="1" type="text" class="grid" id="04"></td>
					<td><input maxlength="1" type="text" class="grid" id="05"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="06"></td>
					<td><input maxlength="1" type="text" class="grid" id="07"></td>
					<td><input maxlength="1" type="text" class="grid" id="08"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="10"></td>
					<td><input maxlength="1" type="text" class="grid" id="11"></td>
					<td><input maxlength="1" type="text" class="grid" id="12"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="13"></td>
					<td><input maxlength="1" type="text" class="grid" id="14"></td>
					<td><input maxlength="1" type="text" class="grid" id="15"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="16"></td>
					<td><input maxlength="1" type="text" class="grid" id="17"></td>
					<td><input maxlength="1" type="text" class="grid" id="18"></td>
				</tr>
				<tr class="bordeTabla">
					<td><input maxlength="1" type="text" class="grid" id="20"></td>
					<td><input maxlength="1" type="text" class="grid" id="21"></td>
					<td><input maxlength="1" type="text" class="grid" id="22"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="23"></td>
					<td><input maxlength="1" type="text" class="grid" id="24"></td>
					<td><input maxlength="1" type="text" class="grid" id="25"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="26"></td>
					<td><input maxlength="1" type="text" class="grid" id="27"></td>
					<td><input maxlength="1" type="text" class="grid" id="28"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="30"></td>
					<td><input maxlength="1" type="text" class="grid" id="31"></td>
					<td><input maxlength="1" type="text" class="grid" id="32"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="33"></td>
					<td><input maxlength="1" type="text" class="grid" id="34"></td>
					<td><input maxlength="1" type="text" class="grid" id="35"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="36"></td>
					<td><input maxlength="1" type="text" class="grid" id="37"></td>
					<td><input maxlength="1" type="text" class="grid" id="38"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="40"></td>
					<td><input maxlength="1" type="text" class="grid" id="41"></td>
					<td><input maxlength="1" type="text" class="grid" id="42"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="43"></td>
					<td><input maxlength="1" type="text" class="grid" id="44"></td>
					<td><input maxlength="1" type="text" class="grid" id="45"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="46"></td>
					<td><input maxlength="1" type="text" class="grid" id="47"></td>
					<td><input maxlength="1" type="text" class="grid" id="48"></td>
				</tr>
				<tr class="bordeTabla">
					<td><input maxlength="1" type="text" class="grid" id="50"></td>
					<td><input maxlength="1" type="text" class="grid" id="51"></td>
					<td><input maxlength="1" type="text" class="grid" id="52"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="53"></td>
					<td><input maxlength="1" type="text" class="grid" id="54"></td>
					<td><input maxlength="1" type="text" class="grid" id="55"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="56"></td>
					<td><input maxlength="1" type="text" class="grid" id="57"></td>
					<td><input maxlength="1" type="text" class="grid" id="58"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="60"></td>
					<td><input maxlength="1" type="text" class="grid" id="61"></td>
					<td><input maxlength="1" type="text" class="grid" id="62"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="63"></td>
					<td><input maxlength="1" type="text" class="grid" id="64"></td>
					<td><input maxlength="1" type="text" class="grid" id="65"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="66"></td>
					<td><input maxlength="1" type="text" class="grid" id="67"></td>
					<td><input maxlength="1" type="text" class="grid" id="68"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="70"></td>
					<td><input maxlength="1" type="text" class="grid" id="71"></td>
					<td><input maxlength="1" type="text" class="grid" id="72"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="73"></td>
					<td><input maxlength="1" type="text" class="grid" id="74"></td>
					<td><input maxlength="1" type="text" class="grid" id="75"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="76"></td>
					<td><input maxlength="1" type="text" class="grid" id="77"></td>
					<td><input maxlength="1" type="text" class="grid" id="78"></td>
				</tr>
				<tr>
					<td><input maxlength="1" type="text" class="grid" id="80"></td>
					<td><input maxlength="1" type="text" class="grid" id="81"></td>
					<td><input maxlength="1" type="text" class="grid" id="82"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="83"></td>
					<td><input maxlength="1" type="text" class="grid" id="84"></td>
					<td><input maxlength="1" type="text" class="grid" id="85"></td>
					<td class="celdaBorde"><input maxlength="1" type="text"
						class="grid" id="86"></td>
					<td><input maxlength="1" type="text" class="grid" id="87"></td>
					<td><input maxlength="1" type="text" class="grid" id="88"></td>
				</tr>
			</table>
			<div class="container-login100-form-btn p-t-20 p-b-20">
				<div class="wrap-login100-form-btn">
					<div class="login100-form-bgbtn"></div>
					<button class="login100-form-btn" onclick="solve()" id="btnSolve">Solve</button>
				</div>
			</div>
			<div class="container-login100-form-btn p-b-20">
				<div class="wrap-login100-form-btn">
					<div class="login100-form-bgbtn"></div>
					<button class="login100-form-btn" onclick="sudoku()" id="btnSudoku">Concede</button>
				</div>
			</div>

		</div>

	</div>
</body>
<script>
	var board;
	var start;
	var end;
	var ws;
	var player0, player1;
	function myFunction() {
		ws = new WebSocket("ws://localhost:8080/gamews");
		ws.onopen = function() {
			var p = {
				TYPE : "joinGame",
				game : "sudoku"
			}
			ws.send(JSON.stringify(p));
		}
		ws.onmessage = function(message) {
			var data = message.data;
			data = JSON.parse(data);
			if (data.TYPE == "search") {
				document.getElementById("demo").innerHTML = "" + data.text;
			} else if (data.TYPE == "match") {
				document.getElementById("demo").innerHTML = "" + data.text;
				player0 = data.player0;
				player1 = data.player1;
				var p = {
					TYPE : "sudoku",
					text : "board"
				}
				ws.send(JSON.stringify(p));
			} else if (data.TYPE == "createBoard") {
				board = data.text.toString();
				start = new Date().getTime();
				var i, j, elem = 0;
				var blank = 48;
				for (i = 0; i < 9; i++) {
					for (j = 0; j < 9; j++) {
						var res = i.toString().concat(j.toString());
						grid = document.getElementById(res);
						if (blank > 0) {
							if (getRandomArbitrary() < 6) {
								grid.value = "";
								blank--;
							} else {
								grid.value = board.charAt(elem);
								grid.readOnly = true;
							}
						} else {
							grid.value = board.charAt(elem);
							grid.readOnly = true;
						}
						elem++;
					}
				}
			} else if (data.TYPE == "winner") {
				document.getElementById("demo").innerHTML = "" + data.text;
				alert(data.text);
				window.location.href = "http://localhost:8080/menu.html";
			}
		}
	}
	function getRandomArbitrary() {
		return Math.round(Math.random() * 10);
	}
	function solve() {
		var correct = true;
		var i, j, elem = 0;
		for (i = 0; i < 9; i++) {
			for (j = 0; j < 9; j++) {
				var res = i.toString().concat(j.toString());
				grid = document.getElementById(res);
				if (grid.value != board.charAt(elem)) {
					grid.style.background = "#EB1616";
					correct = false;
				}else{
					grid.style.background = "#26FA0A";
				}
				elem++;
			}
		}
		if (correct == true) {
			var p = {
				TYPE : "sudoku",
				text : "winner",
				player0 : player0.toString(),
				player1 : player1.toString()
			}
			ws.send(JSON.stringify(p));
		}
	}
</script>
</html>
